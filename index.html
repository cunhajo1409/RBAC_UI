<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>

    <meta name="viewport" content="width=device-width, initial-scale=1">   
    <meta charset="utf-8">    

    <title>Role Based Access Control</title>

    <link rel="stylesheet" href="RBAC_Site/Sites/RBAC/SiteAssets/jqueryui/jquery-ui.css">  
    <link rel="stylesheet" href="RBAC_Site/Sites/RBAC/SiteAssets/jqueryui/jquery-ui.theme.css">
    <link rel="stylesheet" href="RBAC_Site/Sites/RBAC/SiteAssets/jqueryui/jquery-ui.structure.css">
    <link rel="stylesheet" href="RBAC_Site/Sites/RBAC/SiteAssets/bootstrap/dist/css/bootstrap.css">
    <link rel="stylesheet" href="RBAC_Site/Sites/RBAC/SiteAssets/bootstrap/dist/css/bootstrap-grid.css">

    <link rel="stylesheet" href="https://kendo.cdn.telerik.com/2021.1.330/styles/kendo.common.min.css">
    <link rel="stylesheet" href="https://kendo.cdn.telerik.com/2021.1.330/styles/kendo.rtl.min.css">
    <link rel="stylesheet" href="https://kendo.cdn.telerik.com/2021.1.330/styles/kendo.default.min.css">
    <link rel="stylesheet" href="https://kendo.cdn.telerik.com/2021.1.330/styles/kendo.mobile.all.min.css">

    <link rel="stylesheet" href="RBAC_Site/Sites/RBAC/SiteAssets/css/RBAC.css">

    <script src="RBAC_Site/Sites/RBAC/SiteAssets/jquery/dist/jquery.js"></script>
    <script src="RBAC_Site/Sites/RBAC/SiteAssets/bootstrap/dist/js/bootstrap.bundle.js"></script>
    <script src="RBAC_Site/Sites/RBAC/SiteAssets/jqueryui/jquery-ui.js"></script>
    <script src="RBAC_Site/Sites/RBAC/SiteAssets/bootstrap/dist/js/bootstrap.js"></script>

    <script src="https://kendo.cdn.telerik.com/2021.1.330/js/jszip.min.js"></script>
    <script src="https://kendo.cdn.telerik.com/2021.1.330/js/kendo.all.min.js"></script>    


    <script src="RBAC_Site/Sites/RBAC/SiteAssets/js/Globals.js"></script>

</head>
    <div id="container">
        <div id="divContentHeader" style="display:block;">

            <div id="divTitle" 
                 class="testClass"
                 style="display:block;
                        max-width: 600px;
                        margin: 10px auto;
                        padding-top: 40px;
                        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                        font-size: 42px;">
                        Role Based Access Control           
            </div>
            <div id="divMenu" style="display:none;">
                <ul id="ulMenu">
                    <li>
                        Users
                        <ul>
                            <li>
                                Accounts
                            </li>
                            <li>
                                Account Types
                            </li>
                        </ul>
                    </li>

                    <li>
                        Groups
                        <ul>
                            <li>
                                Project Groups
                            </li>
                        </ul>
                    </li>
                    <li>
                        Scopes
                    </li>
                 
                    <li>
                        Projects
                    </li>
                    <li>
                        Roles
                    </li>
                    <li>
                        Group Types
                    </li>  
                </ul>
            </div>
        
        </div>

        <div id="divContent" style="display: block;">

            <div id="divADGroupControls" class="contentArea" style="display:none;">
                <div id="divADGroupsCaption" 
                        style= "display:inline-flex;
                                max-width: 600px;
                                margin: 10px auto;
                                padding-top: 20px;
                                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                                font-size: 42px;
                                align-items:flex-start;">
                    Security Groups
                </div>                  
                <div id="divADGroupDetail" style="display:none">
                </div>
                <div id="divADGroupEdit" style="display:none">
                </div>             
                <div id="divGrdADGroups">
                </div>
            </div>

            <div id="divMIPGroupTypeControls" class="contentArea"  style="display:none;">
                <div id="divADGroupTypeCaption" 
                        style= "display:inline-flex;
                                max-width: 600px;
                                margin: 10px auto;
                                padding-top: 20px;
                                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                                font-size: 42px;
                                align-items:flex-start;">
                    Group Types
                </div> 
                <div id="divMIPGroupTypeDetail" style="display:none">
                </div>
                <div id="divMIPGroupTypeEdit" style="display:none">
                </div>
                <div id="divGrdMIPGroupTypes">
                </div>
            </div>
            
            <div id="divADUserControls" class="contentArea"  style="display:none;">
                <div id="divADUsersCaption" 
                        style= "display:inline-flex;
                                max-width: 600px;
                                margin: 10px auto;
                                padding-top: 20px;
                                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                                font-size: 42px;
                                align-items:flex-start;">
                    Users
                </div>  
                <div id="divADUserDetail" style="display:none">
                </div>
                <div id="divADUserEdit" style="display:none">
                </div>
                <script type="text/x-kendo-template" id="userGridTemplate">
                    <a id="userGridColMenu" style="float:right";"</a>
                </script>  
                <div id="divGrdADUsers" style="display:block">
                </div>

            </div>
            
            <div id="divADUserAccountTypeControls" class="contentArea"  style="display:none">
                <div id="divADUserAccountTypesCaption" 
                        style= "display:inline-flex;
                                max-width: 600px;
                                margin: 10px auto;
                                padding-top: 20px;
                                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                                font-size: 42px;
                                align-items:flex-start;">
                    Account Types
                </div>  
                <div id="divADUserAccountTypeDetail" style="display:none">
                </div>
                <div id="divADUserAccountTypesEdit" style="display:none">
                </div>
                <div id="divGrdADUserAccountTypes" style="display:block">
                </div>                
            </div>
            
            <div id="divMIPGroupProjectControls" class="contentArea"  style="display:none">
                <div id="divMIPGroupProjectCaption" 
                        style= "display:inline-flex;
                                max-width: 600px;
                                margin: 10px auto;
                                padding-top: 20px;
                                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                                font-size: 42px;
                                align-items:flex-start;">
                    Projects
                </div>  
                <div id="divMIPGroupProjectDetail" style="display:none">
                </div>
                <div id="divMIPGroupProjectEdit" style="display:none">
                </div>
                <div id="divGrdMIPGroupProjects" style="display:block">
                </div>                
            </div>
            
            <div id="divMIPGroupRoleControls" class="contentArea"  style="display:none">
                <div id="divMIPGroupRoleCaption" 
                        style= "display:inline-flex;
                                max-width: 600px;
                                margin: 10px auto;
                                padding-top: 20px;
                                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                                font-size: 42px;
                                align-items:flex-start;">
                Roles
                </div>  
                <div id="divMIPGroupRoleDetail" style="display:none">
                </div>
                <div id="divMIPGroupRoleEdit" style="display:none">
                </div>
                <div id="divGrdMIPGroupRoles" style="display:block">
                </div>                
            </div>
            
            <div id="divMIPGroupScopeControls" class="contentArea"  style="display:none">
                <div id="divMIPGroupScopeCaption" 
                        style= "display:inline-flex;
                                max-width: 600px;
                                margin: 10px auto;
                                padding-top: 20px;
                                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                                font-size: 42px;
                                align-items:flex-start;">
                Scopes
                </div>  
                <div id="divMIPGroupScopeDetail" style="display:none">
                </div>
                <div id="divMIPGroupScopeEdit" style="display:none">
                </div>
                <div id="divGrdMIPGroupScopes" style="display:block">
                </div>                
            </div>
        </div>



    </div>
    <script>
        init();

        function init()
        {
            loadPage();
        }

        function loadPage()
        {
            $("#ulMenu").kendoMenu({
                select: function(e)
                {
                    var itemText = $(e.item).children(".k-link").text().trim();

                    $(".contentArea").hide();

                    switch (itemText) 
                    {
                        case "Accounts":
                            $("#divADUserControls").show();
                            break;
                        case "Account Types" :
                            $("#divADUserAccountTypeControls").show();
                            break;
                        case "Project Groups": 
                            $("#divADGroupControls").show();
                            break;
                        case "Group Types":
                            $("#divMIPGroupTypeControls").show();
                            break;
                        case "Projects":
                            $("#divMIPGroupProjectControls").show();
                            break;
                        case "Roles":
                            $("#divMIPGroupRoleControls").show();
                            break;
                        case "Scopes":
                            $("#divMIPGroupScopeControls").show();
                            break;
                    }
                }
            });

            $("#divMenu").show();

            $("#divGrdADUsers").kendoGrid(
            {
                dataSource:
                    {
                        type: "odata-v4",
                        transport: 
                            {
                                read: "https://localhost:44395/OData/ADUser"
                            },
                        pageSize: 30,
                    },
                height: 600,
                scrolable: true,
                filterable: true,
                pageable: true,
                sortable:
                {
                  mode:"multiple"
                },
                groupable: true,
                columnMenu: true, 
                columns:[   {selectable:true, width: 40},
                            {title:"Key", field:"user_key", width: 80},
                            {title:"Name", field:"name", width: 380},
                            {title:"User Name", field:"user_name", width: 190},
                            {title:"Company", field:"Company"},
                            {title:"Dept.", field:"Department", width: 190},
                            {title:"Title", field:"Title"},
                            {title:"EMail", field:"Email"},
                            {title:"Phone", field:"Telephone", width: 130},
                            {title:"Status", field:"Enabled", width: 70},
                            {title:"Expired", field:"AccountExpirationDate", width: 110},
                            {title:"Type", field:"AccountType", width: 60}],
            });

            $("#divGrdADUserAccountTypes").kendoGrid(
            {
                dataSource:
                    {
                        type: "odata-v4",
                        transport: 
                            {
                                read: "https://localhost:44395/OData/ADUserAccountType"
                            },
                        pageSize: 30,
                    },                
                height: 600,
                scrolable: true,
                filterable: true,
                pageable: true,
                sortable: {
                    mode:"mutiple"
                },
                groupable:true,
                columnMenu: true,
                columns:
                [
                    {title:"Key", field:"user_type_key", width: 60 },
                    {title:"Name", field:"user_type_name", width: 350 },
                    {title:"Description", field:"user_type_description"}
                ]                 
            });

            $("#divGrdADGroups").kendoGrid(
                {
                    dataSource:
                    {
                        batch: true,
                        type: "odata-v4",
                        transport:
                        {
                            read: 
                            {
                                url: function()
                                {
                                    return  "https://localhost:44395/OData/ADGroup";
                                }
                            },
                            update:
                            {
                                url: function(dataItem)
                                {
                                    return "https://localhost:44395/OData/ADGroup(" + dataItem.group_Key + ")";
                                }
                            },
                            batch:
                            {
                                url: function() 
                                {
                                    "https://localhost:44395/OData/$batch";
                                }
                            },
                            create:
                            {
                                url: function(dataItem)
                                {
                                    delete dataItem.group_Key;
                                    return "https://localhost:44395/OData/ADGroup";
                                }
                            },
                            destroy:
                            {
                                url: function(dataItem)
                                {
                                    return "https://localhost:44395/OData/ADGroup(" + dataItem.group_Key + ")";
                                }
                            }
                        },
                        schema:
                        {
                            model:
                            {
                                id: "group_Key",
                                fields: 
                                {
                                    group_Key: {editable:false, type: "number" },
                                    groupd_id: {type:"string"},
                                    group_scope_code: {type:"string"},
                                    group_project_code: {type:"string"},
                                    group_role_code: {type:"string"},
                                    group_type_code: {type:"string"},
                                    group_description:  {type:"string"},
                                    group_object_category: {type:"string"},
                                    project_owner: {type:"string"},
                                    project_email: {type:"string"},
                                    project_telephone: {type:"string"},
                                    create_date: {type:"date"},
                                    last_updated_date: {type:"date"},
                                    inactivated_date: {type:"date"},
                                    group_project_key: {type:"number"},
                                    group_role_key: {type:"number"},
                                    group_scope_key: {type:"number"},
                                    group_type_key: {type:"Number"},
                                }
                            },  
                        },                          
                        pageSize: 30,
                        serverPaging: true,
                        serverFiltering: true,
                        serverSorting: true
                    },
                    navigatable: true,
                    pageable: true,
                    height: 600,
                    toolbar: ["create","save","cancel"],
                    columns:
                    // [   {selectable:true, width: 40},
                    [   {title: "Key",         field: "group_Key"         , width: 80 },
                        {title: "ID",          field: "group_id"          , width: 320 },
                        {title: "Scope",       field: "group_scope_code"  , width: 80},
                        {title: "Project",     field: "group_project_code", width: 90},
                        {title: "Role",        field: "group_role_code"   , width: 90},
                        {title: "Type",        field: "group_type_code"   , width: 90},
                        {title: "Description", field: "group_description" , width: 400},
                        {title: "Owner",       field: "project_owner"     , width: 60},
                        {title: "EMail",       field: "project_email"     , width: 60},
                        {title: "Phone",       field: "project_telephone" , width: 60},
                        {title: "Inactivated", field: "inactivated_date"  , width: 85},
                        {command: "destroy", title: "&nbsp;", width:150}
                    ],
                    editable: true,
                    // scrollable: true,
                    filterable: true,
                    sortable: true,
                    // sortable: 
                    // {
                    //     mode: "multiple"
                    // },
                    // groupable: true,
                    columnMenu: true, 
                });

            $("#divGrdMIPGroupScopes").kendoGrid({
                dataSource:
                    {   batch:true,
                        type: "odata-v4",
                        transport: 
                            {
                                read: "https://localhost:44395/OData/MIPGroupScope"
                            },
                    },
                navigatable: true,
                pageable: true,
                height: 600,
                columns:
                [   {title:"Code", field:"group_scope_code", width: 120},
                    {title:"Name", field:"group_scope_name", width: 285},
                    {title:"Description", field:"group_scope_description"}
                ],               
                scrollable: true,
                filterable: true,
                sortable:
                {
                    mode:"mutiple"
                },
                groupable:true,
                columnMenu: true,
            });

            $("#divGrdMIPGroupProjects").kendoGrid({
                dataSource:
                {
                    type: "odata-v4",
                    transport: 
                        {
                            read: "https://localhost:44395/OData/MIPGroupProject"
                        },
                    pageSize: 30,
                },                
                height: 600,
                scrolable: true,
                filterable: true,
                pageable: true,
                sortable:
                {
                    mode:"mutiple"
                },
                groupable:true,
                columnMenu: true, 
                columns:
                [   {title:"Code", field:"group_project_code", width: 120},
                    {title:"Name", field:"group_project_name", width: 420},
                    {title:"Description", field:"group_project_description"}
                ],
            });

            $("#divGrdMIPGroupRoles").kendoGrid({
                // dataSource:
                // {
                //     data: MIPGroupRolesArray,
                //     pageSize: 20
                // },
                dataSource:
                {
                    type: "odata-v4",
                    transport: 
                        {
                            read: "https://localhost:44395/OData/MIPGroupRole"
                        },
                    pageSize: 30,
                }, 
                height: 600,
                scrolable: true,
                filterable: true,
                pageable: true,
                sortable: 
                {
                    mode:"mutiple"
                },
                groupable:true,
                columnMenu: true,
                columns:
                [   {title:"Code", field:"group_role_code", width: 120},
                    {title:"Name", field:"group_role_name", width: 260},
                    {title:"Description", field:"group_role_description"}
                ],                 
            });

            $("#divGrdMIPGroupTypes").kendoGrid({
                // dataSource:
                // {
                //         data: MIPGroupTypesArray,
                //         pageSize: 20
                // },
                dataSource:
                {
                    type: "odata-v4",
                    transport: 
                        {
                            read: "https://localhost:44395/OData/MIPGroupType"
                        },
                    pageSize: 30,
                },                 
                height: 600,
                scrolable: true,
                filterable: true,
                pageable: true,
                sortable:
                {
                    mode: "multiple"
                },
                groupable: true,
                columnMenu: true, 
                columns:
                [   {title: "Code", field: "group_type_code", width: 70},
                    {title: "Name", field: "group_type_name", width: 200},
                    {title: "Description", field: "group_type_description", width: 350}
                ]               
            });
        }

</script>
</body>
</html>